---
title: Git åŸºç¡€â€”â€”â€”åˆ›å»ºä»“åº“åŠæäº¤æ›´æ–°
cover: https://cos.asuka-xun.cc/blog/assets/Git-Base-03.jpg
date: 2022/8/23 1:06
categories:
- [Git]
tags:
- Git
---
# Git åŸºç¡€â€”â€”â€”åˆ›å»ºä»“åº“åŠæäº¤æ›´æ–°

## åˆ›å»ºä»“åº“

æœ‰ä¸¤ç§åˆ›å»ºä»“åº“çš„æ–¹æ³•ï¼š
<!-- more -->

1. å°†æ²¡æœ‰è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„æœ¬åœ°ç›®å½•è½¬æ¢ä¸º Git ä»“åº“ï¼›

2. ä»å…¶ä»–æœåŠ¡å™¨å…‹éš†ä¸€ä¸ªå·²å­˜åœ¨çš„ Git ä»“åº“ã€‚

   > æˆ‘ä»¬å°±å¯ä»¥ä» GitHub ä¸Šä½¿ç”¨ 'git clone' è¿™ä¸ªå‘½ä»¤å…‹éš†ä¸€ä¸ª Git ä»“åº“ã€‚

### åœ¨æ²¡æœ‰è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„æœ¬åœ°ç›®å½•åˆå§‹åŒ–ä»“åº“

è¿›å…¥åˆ°ä½ æƒ³è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„ç›®å½•ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
```shell
$ git init
```

è¿™ä¸ªå‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªåä¸º `.git` çš„å­ç›®å½•ï¼Œè¿™ä¸ªå­ç›®å½•å«æœ‰ä½ åˆå§‹åŒ–çš„ Git ä»“åº“ä¸­æ‰€æœ‰çš„å¿…é¡»æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æ˜¯ Git ä»“åº“çš„éª¨å¹²ã€‚ 

ä½¿ç”¨ `git add` å‘½ä»¤æ¥æŒ‡å®šæ‰€éœ€çš„æ–‡ä»¶è¿›è¡Œè·Ÿè¸ªåŠåˆå§‹åŒ–æäº¤ï¼š

```shell
$ git add *.c
$ git add LICENSE
$ git commit -m 'initial project version'
```

`git add` å°†æ–‡ä»¶æäº¤åˆ°æš‚å­˜åŒºã€‚

> å…³äº `LICENSE ` å¼€æºè®¸å¯è¯ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š[å¦‚ä½•é€‰æ‹©å¼€æºè®¸å¯è¯ï¼Ÿ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— (ruanyifeng.com)](https://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html)

`git commit` å°†æš‚å­˜åŒºä¸­çš„æ‰€æœ‰å†…å®¹æäº¤åˆ°å½“å‰åˆ†æ”¯ï¼ˆåˆ›å»ºç‰ˆæœ¬åº“æ—¶ git è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª master åˆ†æ”¯ï¼‰

> `-m` æ˜¯æäº¤ä¿¡æ¯ï¼ŒæŸ¥çœ‹åˆ«äººæˆ–è€…è‡ªå·±çš„å†å²è®°å½•çš„æ—¶å€™ï¼Œè¿™ä¸ªä¸œè¥¿æ˜¯æŒºé‡è¦çš„ã€‚ä»¥ä¸‹æ˜¯ Git çš„æ ‡å‡†æ³¨è§£ï¼š
>
> ```
> ç¬¬1è¡Œï¼šæäº¤ä¿®æ”¹å†…å®¹çš„æ‘˜è¦
> ç¬¬2è¡Œï¼šç©ºè¡Œ
> ç¬¬3è¡Œä»¥åï¼šä¿®æ”¹çš„ç†ç”±
> ```

### å…‹éš†ç°æœ‰çš„ä»“åº“

`git clone` å‘½ä»¤ï¼š

```shell
$ git clone <url>
```

æ¯”å¦‚å…‹éš†æˆ‘çš„ä¸€ä¸ªé¡¹ç›®ï¼š

```shell
$ git clone https://github.com/Xunop/kakaBot
```

è¿™ä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå« kakaBot çš„ç›®å½•ï¼Œå¹¶åœ¨è¿™ä¸ªç›®å½•ä¸‹åˆå§‹åŒ–ä¸€ä¸ª `.git` æ–‡ä»¶å¤¹ï¼Œ ä»è¿œç¨‹ä»“åº“æ‹‰å–ä¸‹æ‰€æœ‰æ•°æ®æ”¾å…¥ `.git` æ–‡ä»¶å¤¹ï¼Œç„¶åä»ä¸­è¯»å–æœ€æ–°ç‰ˆæœ¬çš„æ–‡ä»¶çš„æ‹·è´ã€‚å¯ä»¥åœ¨åé¢æ·»åŠ è‡ªå®šä¹‰æœ¬åœ°ä»“åº“çš„åå­—ã€‚

## ä¸¾ä¾‹

æˆ‘ä¼šå°†å‘½ä»¤åŠæ‰§è¡Œç»“æœæ”¾åœ¨ä¸€èµ·ã€‚ä¸­é—´ä¼šå¤¹å¸¦ Git å‘½ä»¤çš„ä»‹ç»ã€‚

### åˆå§‹åŒ–ä»“åº“

```shell
$ git init
Initialized empty Git repository in D:/gitDemo/.git/
```

### æŸ¥çœ‹å½“å‰æ–‡ä»¶çŠ¶æ€

ä½¿ç”¨   `git status` æŸ¥çœ‹å½“å‰æ–‡ä»¶çŠ¶æ€ï¼š

```shell
$ git status
On branch main
No commits yet
nothing to commit (create/copy files and use "git add" to track)
```

> `git status` å‘½ä»¤è¾“å‡ºè¿˜å¯ä»¥ä½¿ç”¨ç¼©çŸ­ï¼Œä½¿ç”¨ `-s` æˆ–è€… `-short` é€‰é¡¹å¯ä»¥ç¼©çŸ­çŠ¶æ€å‘½ä»¤çš„è¾“å‡ºã€‚
>
> ```shell
> $ git status -s
> A  README
> ```
>
> æ–°æ·»åŠ çš„æœªè·Ÿè¸ªæ–‡ä»¶å‰é¢æœ‰ `??` æ ‡è®°ï¼Œæ–°æ·»åŠ åˆ°æš‚å­˜åŒºä¸­çš„æ–‡ä»¶å‰é¢æœ‰ `A` æ ‡è®°ï¼Œä¿®æ”¹è¿‡çš„æ–‡ä»¶å‰é¢æœ‰ `M` æ ‡è®°ã€‚ è¾“å‡ºä¸­æœ‰ä¸¤æ ï¼Œå·¦æ æŒ‡æ˜äº†æš‚å­˜åŒºçš„çŠ¶æ€ï¼Œå³æ æŒ‡æ˜äº†å·¥ä½œåŒºçš„çŠ¶æ€ã€‚

è¿™è¯´æ˜æˆ‘ä»¬ç°åœ¨çš„å·¥ä½œç›®å½•ç›¸å½“å¹²å‡€ã€‚æ¢å¥è¯è¯´ï¼Œæ‰€æœ‰å·²è·Ÿè¸ªæ–‡ä»¶åœ¨ä¸Šæ¬¡æäº¤åéƒ½æœªè¢«æ›´æ”¹è¿‡ã€‚è¿™ä¸ªå‘½ä»¤è¿˜æ˜¾ç¤ºäº†å½“å‰åˆ†æ”¯ï¼Œæˆ‘å½“å‰åˆ†æ”¯åæ˜¯ `main`ã€‚å¥½åƒæ˜¯ä¹‹å‰æˆ‘å­¦é•¿å¸®æˆ‘æ”¹æˆ `main` çš„ã€‚

åˆ›å»ºä¸€ä¸ª `README` æ–‡ä»¶ã€‚å¦‚æœä¹‹å‰ä¸å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨ `git status` å‘½ä»¤ä¼šæœ‰çœ‹åˆ°ä¸€ä¸ªæœªè·Ÿè¸ªæ–‡ä»¶ï¼š

```shell
$ echo 'README' > README
$ git status
On branch main
No commits yet
Untracked files:
  (use "git add <file>..." to include in what will be committed)
        README
nothing added to commit but untracked files present (use "git add" to track)
```

`Untracked files` è¡¨ç¤ºä¸ºè·Ÿè¸ªæ–‡ä»¶æ¸…å•ã€‚æœªè·Ÿè¸ªçš„æ–‡ä»¶æ„å‘³ç€ Git åœ¨ä¹‹å‰çš„å¿«ç…§ï¼ˆæäº¤ï¼‰ä¸­æ²¡æœ‰è¿™äº›æ–‡ä»¶ï¼›Git ä¸ä¼šè‡ªåŠ¨å°†ä¹‹çº³å…¥è·Ÿè¸ªèŒƒå›´ã€‚

### è·Ÿè¸ªæ–°æ–‡ä»¶

ä½¿ç”¨å‘½ä»¤ `git add` å¼€å§‹è·Ÿè¸ªä¸€ä¸ªæ–‡ä»¶ã€‚ æ‰€ä»¥ï¼Œè¦è·Ÿè¸ª `README` æ–‡ä»¶ï¼Œè¿è¡Œï¼š

```shell
$ git add README
```

æ­¤æ—¶å†è¿è¡Œ `git status` å‘½ä»¤ï¼Œä¼šçœ‹åˆ° `README` æ–‡ä»¶å·²è¢«è·Ÿè¸ªï¼Œå¹¶å¤„äºæš‚å­˜çŠ¶æ€ï¼š

```shell
$ git status
On branch main
No commits yet
Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
        new file:   README
```

åªè¦åœ¨ `Changes to be committed` è¿™è¡Œä¸‹é¢çš„ï¼Œå°±è¯´æ˜æ˜¯å·²æš‚å­˜çŠ¶æ€ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨æäº¤ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å°±ä¼šä»æš‚å­˜åŒºæäº¤åˆ°æˆ‘ä»¬çš„åˆ†æ”¯ `main` ä¸­ã€‚ `git add` å‘½ä»¤ä½¿ç”¨æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ä½œä¸ºå‚æ•°ï¼›å¦‚æœå‚æ•°æ˜¯ç›®å½•çš„è·¯å¾„ï¼Œè¯¥å‘½ä»¤å°†é€’å½’åœ°è·Ÿè¸ªè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚

### æš‚å­˜å·²ä¿®æ”¹çš„æ–‡ä»¶

æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ `test.md`ï¼Œç„¶åå°†å®ƒåŠ å…¥åˆ°æš‚å­˜åŒºä¸­ã€‚ä¹‹åæˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶å†æŸ¥çœ‹çŠ¶æ€ï¼š

```shell
$ git status
On branch main
No commits yet
Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
        new file:   README
        new file:   test.md
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   test.md
```

è¿™ä¸ªæ–‡ä»¶å‡ºç°åœ¨ `Changes not staged for commit` è¿™è¡Œä¸‹é¢ï¼Œè¯´æ˜å·²è·Ÿè¸ªæ–‡ä»¶çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†è¿˜æ²¡æœ‰æ”¾åˆ°æš‚å­˜åŒºã€‚ è¦æš‚å­˜è¿™æ¬¡æ›´æ–°ï¼Œéœ€è¦è¿è¡Œ `git add` å‘½ä»¤ã€‚ è¿™æ˜¯ä¸ªå¤šåŠŸèƒ½å‘½ä»¤ï¼šå¯ä»¥ç”¨å®ƒå¼€å§‹è·Ÿè¸ªæ–°æ–‡ä»¶ï¼Œæˆ–è€…æŠŠå·²è·Ÿè¸ªçš„æ–‡ä»¶æ”¾åˆ°æš‚å­˜åŒºï¼Œè¿˜èƒ½ç”¨äºåˆå¹¶æ—¶æŠŠæœ‰å†²çªçš„æ–‡ä»¶æ ‡è®°ä¸ºå·²è§£å†³çŠ¶æ€ç­‰ã€‚è¿è¡Œ `git add` å°†è¿™ä¸ªæ–‡ä»¶åŠ å…¥åˆ°æš‚å­˜åŒºä¸­ï¼Œå†æ¬¡æŸ¥çœ‹çŠ¶æ€ï¼š

```shell
$ git status
On branch main
No commits yet
Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
        new file:   README
        new file:   test.md
```

å¦‚æœæ­¤æ—¶æˆ‘ä»¬å†æ¬¡ä¿®æ”¹ `test.md` æ–‡ä»¶ï¼Œç„¶åæŸ¥çœ‹çŠ¶æ€ï¼š

```shell
$ git status
On branch main
No commits yet
Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
        new file:   README
        new file:   test.md
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   test.md
```

`test.md` åŒæ—¶å‡ºç°åœ¨æš‚å­˜åŒºè·Ÿéæš‚å­˜åŒºï¼Œå¦‚æœæˆ‘ä»¬æ­¤æ—¶æäº¤çš„è¯ï¼Œæäº¤çš„æ˜¯åœ¨æš‚å­˜åŒºä¸­çš„æ–‡ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬æœ€åä¸€æ¬¡ä¿®æ”¹çš„æ–‡ä»¶è¿˜æ²¡åŠ å…¥åˆ°æš‚å­˜åŒºã€‚

### æŸ¥çœ‹å·²æš‚å­˜å’Œæœªæš‚å­˜çš„ä¿®æ”¹

è¿™ä¸ªçš„è¯å¦‚æœä½¿ç”¨å¯è§†åŒ–å€’æ˜¯å¾ˆæ¸…æ™°ï¼Œç›´æ¥çœ‹å‘½ä»¤è¡Œè¿˜æ˜¯æœ‰ç‚¹ç´¯ã€‚

ä½¿ç”¨ `git diff` å‘½ä»¤å¯ä»¥é€šè¿‡æ–‡ä»¶è¡¥ä¸çš„æ ¼å¼æ›´åŠ å…·ä½“åœ°æ˜¾ç¤ºå“ªäº›è¡Œå‘ç”Ÿäº†æ”¹å˜ã€‚

ä½¿ç”¨ `git diff --staged` å‘½ä»¤æˆ–è€… `git diff --cached` æŸ¥çœ‹å·²æš‚å­˜çš„å°†è¦æ·»åŠ åˆ°ä¸‹æ¬¡æäº¤é‡Œçš„å†…å®¹ã€‚ è¿™æ¡å‘½ä»¤å°†æ¯”å¯¹å·²æš‚å­˜æ–‡ä»¶ä¸æœ€åä¸€æ¬¡æäº¤çš„æ–‡ä»¶å·®å¼‚ï¼š

```shell
$ git diff --staged
diff --git a/README b/README
new file mode 100644
index 0000000..e845566
--- /dev/null
+++ b/README
@@ -0,0 +1 @@
+README
diff --git a/test.md b/test.md
new file mode 100644
index 0000000..36198c5
--- /dev/null
+++ b/test.md
@@ -0,0 +1,3 @@
+test
+test1
+test2
```

> æˆ‘ä¹ˆå¯ä»¥ä½¿ç”¨ `git difftool` è°ƒç”¨ä¸€äº›å¯è§†åŒ–è½¯ä»¶å¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹ä¿®æ”¹ï¼Œå¦‚æœä½ æ²¡æœ‰ä¸‹è½½çš„è¯ä¼šæç¤ºä½ ä¸‹è½½çš„ã€‚
>
> ä½¿ç”¨ `git difftool --tool-help` å‘½ä»¤æ¥çœ‹ä½ çš„ç³»ç»Ÿæ”¯æŒå“ªäº› Git Diff æ’ä»¶ã€‚

### æäº¤æ›´æ–°

ä¸­é—´æ’äº†è¿™ä¹ˆå¤šæ­¥éª¤ï¼Œè¿™é‡Œæ€»ç®—å¯ä»¥æäº¤äº†ã€‚

```shell
git commit
```

è¿™æ ·ä¼šå¯åŠ¨ä½ é€‰æ‹©çš„æ–‡æœ¬ç¼–è¾‘å™¨æ¥è¾“å…¥æäº¤è¯´æ˜ã€‚æˆ‘æ˜¯ç”¨ vscodeã€‚
> å¯åŠ¨çš„ç¼–è¾‘å™¨æ˜¯é€šè¿‡ Shell çš„ç¯å¢ƒå˜é‡ `EDITOR` æŒ‡å®šçš„ï¼Œä¸€èˆ¬ä¸º vim æˆ– emacsã€‚ å¯ä»¥ä½¿ç”¨ `git config --global core.editor` å‘½ä»¤è®¾ç½®å–œæ¬¢çš„ç¼–è¾‘å™¨ã€‚ç›´æ¥æ”¹æ–‡ä»¶ `~/.gitconfig` è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰ç¼–è¾‘å™¨é…ç½®è®¾ç½®ã€‚æˆ‘åœ¨å‰é¢çš„æ–‡ç« ä¸­ä¹Ÿæœ‰æåˆ° `--global` é€‰é¡¹æ›´æ”¹æ–‡ä»¶æ˜¯åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚

ç¼–å†™äº†æäº¤è¯´æ˜ç›´æ¥é€€å‡ºç¼–è¾‘å™¨å°±è¡Œäº†ã€‚æ‰“å¼€ç¼–è¾‘å™¨ä¼šæ˜¾ç¤ºæ›´æ–°å†…å®¹ï¼Œä¸è¿‡è¿™äº›æ›´æ–°å†…å®¹æ˜¯ç”¨ `#` æ³¨é‡Šäº†çš„ï¼Œä¸ä¼šæäº¤ã€‚

ä½¿ç”¨ `-m` é€‰é¡¹æäº¤ï¼š

```shell
git commit -m 'first commit'
```

> æ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨ `git log` æŸ¥çœ‹ git æ—¥å¿—ï¼š
>
> ```shell
> $ git log
> commit 5abccae89d89d1bdb52a724d7bc40da0dd685c2e (HEAD -> main)
> Author: Xunop <1234567@qq.com>
> Date:   Mon Aug 22 23:13:55 2022 +0800
> ```
>
> å‡ºç°äº†æˆ‘ä»¬çš„æäº¤è®°å½•

### è·³è¿‡æš‚å­˜åŒº

æ¯æ¬¡æäº¤éƒ½éœ€è¦å°†æ–‡ä»¶åŠ å…¥åˆ°æš‚å­˜åŒºï¼Œæ–‡ä»¶ä¸€å¤šå°±æœ‰ç‚¹ç¹çï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€‰é¡¹ `-a` è¿™æ · Git ä¼šè‡ªåŠ¨æŠŠæ‰€æœ‰**å·²ç»è·Ÿè¸ª**è¿‡çš„æ–‡ä»¶æš‚å­˜èµ·æ¥ä¸€å¹¶æäº¤ï¼Œä»è€Œè·³è¿‡ `git add` æ­¥éª¤ï¼š

```shell
git commit -a -m 'add df'
```

ä¸è¿‡éœ€æ³¨æ„ï¼Œæœ‰æ—¶è¿™ä¸ªé€‰é¡¹ä¼šå°†ä¸éœ€è¦çš„æ–‡ä»¶æ·»åŠ åˆ°æäº¤ä¸­ã€‚

### ç§»é™¤æ–‡ä»¶

å…¶å® Git ä¹Ÿæç¤ºäº†æˆ‘ä»¬ï¼Œåœ¨ä¹‹å‰çš„å‘½ä»¤è¾“å‡ºä¸­å‡ºç°è¿‡è¿™ç§æç¤ºï¼š

```shell
 (use "git rm --cached <file>..." to unstage)
```
è¿˜æœ‰è¿™ç§ï¼š

```shell
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
```

åˆæ¡åˆ°ä¸€ä¸ªå‘½ä»¤ `git restore <file>...` 

> è¿™ä¸ªå‘½ä»¤æœ‰ç‚¹å¥½ç©ï¼Œå¯ä»¥æ¢å¤å·²åˆ é™¤æ–‡ä»¶ã€‚
>
> å¦‚æœä½ åˆ é™¤ä¸€ä¸ªå·²ç»åŠ å…¥åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œä¸è¿‡è¿˜æ²¡æœ‰æš‚å­˜è¿™ä¸ªæ›´æ”¹ï¼Œä¹Ÿå°±æ˜¯å‡ºç°æˆ‘è¯´çš„*ç®€å•åœ°ä»å·¥ä½œç›®å½•ä¸­æ‰‹å·¥åˆ é™¤æ–‡ä»¶*çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `git restore` æ¥æ¢å¤è¿™ä¸ªæ–‡ä»¶ï¼š
>
> ```shell
> rm file1.txt
> $ ll
> total 2
> -rw-r--r-- 1 xun 197121 32  8æœˆ 22 23:24 df
> -rw-r--r-- 1 xun 197121  7  8æœˆ 22 22:38 README
> $ git restore file1.txt
> $ ll
> total 3
> -rw-r--r-- 1 xun 197121 32  8æœˆ 22 23:24 df
> -rw-r--r-- 1 xun 197121  9  8æœˆ 22 23:59 file1.txt
> -rw-r--r-- 1 xun 197121  7  8æœˆ 22 22:38 README
> ```
>
> å¦‚æœæˆ‘ä»¬åˆ é™¤äº†ä¸€ä¸ªå·²ç»åŠ å…¥åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿˜æš‚å­˜äº†è¿™ä¸ªæ›´æ”¹ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°±ä¼šæŠ¥é”™ï¼š
>
> ```shell
> $ rm file1.txt
> $ git add .
> $ git restore file1.txt
> error: pathspec 'file1.txt' did not match any file(s) known to git
> ```
>
> > å…³äº `git add .` æ˜¯æ·»åŠ å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒºã€‚
>
> è¿™æ ·å°±ä¸èƒ½æ¢å¤äº†å—ï¼Ÿå¦‚æœä½ ä¹‹å‰å·²ç»æäº¤è¿‡è¿™ä¸ªæ–‡ä»¶çš„è¯è¿˜èƒ½æ¢å¤çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨ `git restore --staged --worktree <filename>` è¿™ä¸ªå‘½ä»¤ï¼š
>
> ```shell
> $ git restore --staged --worktree file1.txt
> ```
>
> > `--staged` å‚æ•°å‘Šè¯‰ Git ä» HEAD æ¢å¤ç´¢å¼•ï¼ˆæš‚å­˜åŒºï¼‰ä¸­çš„æ–‡ä»¶ï¼Œ`--worktree` å‘Šè¯‰ Git æ¢å¤å·¥ä½œæ ‘ï¼ˆå·¥ä½œåŒºï¼‰ã€‚
>
> è¿™ä¸ªæ–‡ä»¶æ¢å¤çš„åªæ˜¯æˆ‘ä»¬ä¹‹å‰æäº¤çš„ï¼Œå¦‚æœæˆ‘ä»¬å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œè¿‡æ›´æ”¹ä¸”æ²¡æœ‰æäº¤åˆ°å½“å‰åˆ†æ”¯ï¼Œé‚£ä¹ˆé‚£äº›ä¿®æ”¹æ˜¯æ²¡æœ‰æ¢å¤çš„ã€‚
>
> è¿˜æœ‰æ›´æé™çš„æƒ…å†µå°±è¦ä½¿ç”¨ `git checkout` å‘½ä»¤äº†ã€‚å¯ä»¥å»äº†è§£ä¸€ä¸‹ã€‚è¿™ç¯‡æ–‡ç« æœ‰è®°è½½çš„ï¼š[Recovering Deleted Files in GitHub - Rewind](https://rewind.com/blog/recovering-deleted-files-in-github/)ã€‚

è¦ä» Git ä¸­ç§»é™¤æŸä¸ªæ–‡ä»¶ï¼Œå°±å¿…é¡»è¦ä»å·²è·Ÿè¸ªæ–‡ä»¶æ¸…å•ä¸­ç§»é™¤ï¼ˆç¡®åˆ‡åœ°è¯´ï¼Œæ˜¯ä»æš‚å­˜åŒºåŸŸç§»é™¤ï¼‰ï¼Œç„¶åæäº¤ã€‚ å¯ä»¥ç”¨ `git rm` å‘½ä»¤å®Œæˆæ­¤é¡¹å·¥ä½œï¼Œ**å¹¶è¿å¸¦ä»å·¥ä½œç›®å½•ä¸­åˆ é™¤æŒ‡å®šçš„æ–‡ä»¶**ï¼Œè¿™æ ·ä»¥åå°±ä¸ä¼šå‡ºç°åœ¨æœªè·Ÿè¸ªæ–‡ä»¶æ¸…å•ä¸­äº†ã€‚

å¦‚æœåªæ˜¯ç®€å•åœ°ä»å·¥ä½œç›®å½•ä¸­æ‰‹å·¥åˆ é™¤æ–‡ä»¶ï¼ˆæˆ‘è¿™é‡Œåˆ é™¤ `test.md` æ–‡ä»¶ï¼‰ï¼Œè¿è¡Œ `git status` æ—¶å°±ä¼šåœ¨ â€œChanges not staged for commitâ€ éƒ¨åˆ†ï¼ˆä¹Ÿå°±æ˜¯ *æœªæš‚å­˜æ¸…å•*ï¼‰çœ‹åˆ°ï¼š

```shell
$ git status
On branch main
Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        deleted:    test.md
no changes added to commit (use "git add" and/or "git commit -a")
```

å¦‚æœè¿™æ—¶å€™æäº¤è¿˜æ˜¯æ˜¾ç¤ºè¿™ä¸ªçš„ï¼Œå‡ºç°è¿™ä¸ªçš„åŸå› æ˜¯æˆ‘ä»¬åˆ é™¤ï¼ˆä¿®æ”¹ï¼‰äº† `test.md` æ–‡ä»¶ä½†æ˜¯å°šæœªæ·»åŠ åˆ°æš‚å­˜åŒºã€‚å‰é¢å½“æˆ‘ä»¬ä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ä½†æ˜¯æ²¡æœ‰åŠ å…¥åˆ°æš‚å­˜åŒºä¹Ÿæ˜¯æ˜¾ç¤ºè¿™ä¸ªã€‚

å¦‚æœæˆ‘ä»¬ä½¿ç”¨ `git rm test.md` å°±ä¸ä¼šæ˜¾ç¤ºè¿™ä¸ªï¼š

```shell
$ git rm test.md
rm 'test.md'
$ git status
On branch main
Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
        deleted:    test.md
```

å¦‚æœè¦åˆ é™¤ä¹‹å‰ä¿®æ”¹è¿‡æˆ–å·²ç»æ”¾åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å¼ºåˆ¶åˆ é™¤é€‰é¡¹ `-f`ã€‚è¿™æ˜¯é˜²æ­¢è¯¯åˆ ï¼Œå› ä¸º Git å¹¶ä¸èƒ½æ¢å¤è¿™äº›æ•°æ®ã€‚

æœ‰ä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬åªæ˜¯æƒ³æŠŠè¿™ä¸ªæ–‡ä»¶ä» Git ä»“åº“ä¸­åˆ é™¤è€Œä¸æ˜¯åœ¨æˆ‘ä»¬å·¥ä½œç›®å½•ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬æœ¬åœ°ï¼‰ä¸­ä¹Ÿåˆ é™¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ `git rm` å‘½ä»¤æ—¶ä¼šæŠŠæˆ‘ä»¬æœ¬åœ°çš„è¿™ä¸ªæ–‡ä»¶ä¹Ÿåˆ é™¤ã€‚æœ‰æ—¶å€™æˆ‘ä»¬å°±é‡åˆ°å¿˜è®°æŠŠä¸€äº›æ–‡ä»¶æ·»åŠ åˆ° `.gitignore` æ–‡ä»¶é‡Œï¼ˆ`.gitignore` æ–‡ä»¶ä¸€æ—¦ç¡®å®šå°±ä¸èƒ½å†æ”¹ï¼Œå®ƒçš„ä»‹ç»åœ¨åé¢ï¼‰ï¼Œç„¶åè¢«æ·»åŠ åˆ°æš‚å­˜åŒºé‡Œ çš„æƒ…å†µï¼ˆå†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™åˆšå¥½é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªä¸èƒ½ä¸Šä¼ çš„é…ç½®æ–‡ä»¶å·®ç‚¹ç»™æˆ‘ä¸Šä¼ äº†ï¼‰ã€‚è¿™æ—¶æˆ‘ä»¬ä½¿ç”¨ `--cached` é€‰é¡¹å°±å¾ˆæœ‰ç”¨äº†ï¼š

```shell
$ git rm --cached README
```

ä½¿ç”¨è¿™ä¸ªä¸ä¼šä»æˆ‘ä»¬æœ¬åœ°åˆ é™¤ï¼Œè€Œæ˜¯è®© Git ä¸å†è·Ÿè¸ªã€‚

> `git rm` å‘½ä»¤åé¢å¯ä»¥åˆ—å‡ºæ–‡ä»¶æˆ–è€…ç›®å½•çš„åå­—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `glob` æ¨¡å¼ã€‚æ¯”å¦‚ï¼š
>
> ```console
> $ git rm log/\*.log
> ```
>
> æ³¨æ„åˆ°æ˜Ÿå· `*` ä¹‹å‰çš„åæ–œæ  `\`ï¼Œ å› ä¸º Git æœ‰å®ƒè‡ªå·±çš„æ–‡ä»¶æ¨¡å¼æ‰©å±•åŒ¹é…æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ç”¨ shell æ¥å¸®å¿™å±•å¼€ã€‚ æ­¤å‘½ä»¤åˆ é™¤ `log/` ç›®å½•ä¸‹æ‰©å±•åä¸º `.log` çš„æ‰€æœ‰æ–‡ä»¶ã€‚ ç±»ä¼¼çš„æ¯”å¦‚ï¼š
>
> ```console
> $ git rm \*~
> ```
>
> è¯¥å‘½ä»¤ä¼šåˆ é™¤æ‰€æœ‰åå­—ä»¥ `~` ç»“å°¾çš„æ–‡ä»¶ã€‚

### ç§»åŠ¨æ–‡ä»¶

æ—¢ç„¶å¦‚æ­¤ï¼Œå½“ä½ çœ‹åˆ° Git çš„ `mv` å‘½ä»¤æ—¶ä¸€å®šä¼šå›°æƒ‘ä¸å·²ã€‚ è¦åœ¨ Git ä¸­å¯¹æ–‡ä»¶æ”¹åï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š

```shell
$ git mv fileNem newFileName
```

```shell
$ git mv README.md README
$ git status
On branch main
Your branch is up-to-date with 'origin/main'.
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    renamed:    README.md -> README
```

å…¶å®ï¼Œè¿è¡Œ `git mv` å°±ç›¸å½“äºè¿è¡Œäº†ä¸‹é¢ä¸‰æ¡å‘½ä»¤ï¼š

```console
$ mv README.md README
$ git rm README.md
$ git add README
```

è¿è¡Œ `git mv` å°±ç›¸å½“äºè¿è¡Œäº†ä¸‹é¢ä¸‰æ¡å‘½ä»¤ï¼š

```shell
$ mv README.md README
$ git rm README.md
$ git add README
```

### å¿½ç•¥æ–‡ä»¶

ä¸€èˆ¬æˆ‘ä»¬æ€»ä¼šæœ‰äº›æ–‡ä»¶æ— éœ€çº³å…¥ Git çš„ç®¡ç†ï¼Œä¹Ÿä¸å¸Œæœ›å®ƒä»¬æ€»å‡ºç°åœ¨æœªè·Ÿè¸ªæ–‡ä»¶åˆ—è¡¨ã€‚ é€šå¸¸éƒ½æ˜¯äº›è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ¯”å¦‚æ—¥å¿—æ–‡ä»¶ï¼Œæˆ–è€…ç¼–è¯‘è¿‡ç¨‹ä¸­åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶ç­‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º `.gitignore` çš„æ–‡ä»¶ï¼Œåˆ—å‡ºè¦å¿½ç•¥çš„æ–‡ä»¶çš„æ¨¡å¼ã€‚ æ¥çœ‹ä¸€ä¸ªå®é™…çš„ `.gitignore` ä¾‹å­ï¼š

```console
$ cat .gitignore
*.[oa]
*~
```

ç¬¬ä¸€è¡Œå‘Šè¯‰ Git å¿½ç•¥æ‰€æœ‰ä»¥ `.o` æˆ– `.a` ç»“å°¾çš„æ–‡ä»¶ã€‚ä¸€èˆ¬è¿™ç±»å¯¹è±¡æ–‡ä»¶å’Œå­˜æ¡£æ–‡ä»¶éƒ½æ˜¯ç¼–è¯‘è¿‡ç¨‹ä¸­å‡ºç°çš„ã€‚ ç¬¬äºŒè¡Œå‘Šè¯‰ Git å¿½ç•¥æ‰€æœ‰åå­—ä»¥æ³¢æµªç¬¦ï¼ˆ~ï¼‰ç»“å°¾çš„æ–‡ä»¶ï¼Œè®¸å¤šæ–‡æœ¬ç¼–è¾‘è½¯ä»¶ï¼ˆæ¯”å¦‚ Emacsï¼‰éƒ½ç”¨è¿™æ ·çš„æ–‡ä»¶åä¿å­˜å‰¯æœ¬ã€‚ æ­¤å¤–ï¼Œä½ å¯èƒ½è¿˜éœ€è¦å¿½ç•¥ logï¼Œtmp æˆ–è€… pid ç›®å½•ï¼Œä»¥åŠè‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£ç­‰ç­‰ã€‚ è¦å…»æˆä¸€å¼€å§‹å°±ä¸ºä½ çš„æ–°ä»“åº“è®¾ç½®å¥½ `.gitignore` æ–‡ä»¶çš„ä¹ æƒ¯ï¼Œä»¥å…å°†æ¥è¯¯æäº¤è¿™ç±»æ— ç”¨çš„æ–‡ä»¶ã€‚

æ–‡ä»¶ `.gitignore` çš„æ ¼å¼è§„èŒƒå¦‚ä¸‹ï¼š

- æ‰€æœ‰ç©ºè¡Œæˆ–è€…ä»¥ `#` å¼€å¤´çš„è¡Œéƒ½ä¼šè¢« Git å¿½ç•¥ã€‚
- å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ glob æ¨¡å¼åŒ¹é…ï¼Œå®ƒä¼šé€’å½’åœ°åº”ç”¨åœ¨æ•´ä¸ªå·¥ä½œåŒºä¸­ã€‚
- åŒ¹é…æ¨¡å¼å¯ä»¥ä»¥ï¼ˆ`/`ï¼‰å¼€å¤´é˜²æ­¢é€’å½’ã€‚
- åŒ¹é…æ¨¡å¼å¯ä»¥ä»¥ï¼ˆ`/`ï¼‰ç»“å°¾æŒ‡å®šç›®å½•ã€‚
- è¦å¿½ç•¥æŒ‡å®šæ¨¡å¼ä»¥å¤–çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥åœ¨æ¨¡å¼å‰åŠ ä¸Šå¹å·ï¼ˆ`!`ï¼‰å–åã€‚

æ‰€è°“çš„ glob æ¨¡å¼æ˜¯æŒ‡ shell æ‰€ä½¿ç”¨çš„ç®€åŒ–äº†çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ æ˜Ÿå·ï¼ˆ`*`ï¼‰åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ï¼›`[abc]` åŒ¹é…ä»»ä½•ä¸€ä¸ªåˆ—åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦ ï¼ˆè¿™ä¸ªä¾‹å­è¦ä¹ˆåŒ¹é…ä¸€ä¸ª aï¼Œè¦ä¹ˆåŒ¹é…ä¸€ä¸ª bï¼Œè¦ä¹ˆåŒ¹é…ä¸€ä¸ª cï¼‰ï¼› é—®å·ï¼ˆ`?`ï¼‰åªåŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼›å¦‚æœåœ¨æ–¹æ‹¬å·ä¸­ä½¿ç”¨çŸ­åˆ’çº¿åˆ†éš”ä¸¤ä¸ªå­—ç¬¦ï¼Œ è¡¨ç¤ºæ‰€æœ‰åœ¨è¿™ä¸¤ä¸ªå­—ç¬¦èŒƒå›´å†…çš„éƒ½å¯ä»¥åŒ¹é…ï¼ˆæ¯”å¦‚ `[0-9]` è¡¨ç¤ºåŒ¹é…æ‰€æœ‰ 0 åˆ° 9 çš„æ•°å­—ï¼‰ã€‚ ä½¿ç”¨ä¸¤ä¸ªæ˜Ÿå·ï¼ˆ`**`ï¼‰è¡¨ç¤ºåŒ¹é…ä»»æ„ä¸­é—´ç›®å½•ï¼Œæ¯”å¦‚ `a/**/z` å¯ä»¥åŒ¹é… `a/z` ã€ `a/b/z` æˆ– `a/b/c/z` ç­‰ã€‚

æˆ‘ä»¬å†çœ‹ä¸€ä¸ª `.gitignore` æ–‡ä»¶çš„ä¾‹å­ï¼š

```
# å¿½ç•¥æ‰€æœ‰çš„ .a æ–‡ä»¶
*.a

# ä½†è·Ÿè¸ªæ‰€æœ‰çš„ lib.aï¼Œå³ä¾¿ä½ åœ¨å‰é¢å¿½ç•¥äº† .a æ–‡ä»¶
!lib.a

# åªå¿½ç•¥å½“å‰ç›®å½•ä¸‹çš„ TODO æ–‡ä»¶ï¼Œè€Œä¸å¿½ç•¥ subdir/TODO
/TODO

# å¿½ç•¥ä»»ä½•ç›®å½•ä¸‹åä¸º build çš„æ–‡ä»¶å¤¹
build/

# å¿½ç•¥ doc/notes.txtï¼Œä½†ä¸å¿½ç•¥ doc/server/arch.txt
doc/*.txt

# å¿½ç•¥ doc/ ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ä¸‹çš„ .pdf æ–‡ä»¶
doc/**/*.pdf
```

æˆ‘ä¸€èˆ¬ä½¿ç”¨ IDEA è‡ªå¸¦çš„ğŸ˜ï¼Œä¸è¿‡ Github æœ‰ä¸€ä¸ªé¡¹ç›®æ˜¯åŒ…æ‹¬äº†å¾ˆå¤šç§æƒ…å†µçš„`.gitignore` æ–‡ä»¶åˆ—è¡¨ï¼Œçœ‹è¿™é‡Œï¼š[github/gitignore: A collection of useful .gitignore templates](https://github.com/github/gitignore)ã€‚æˆ‘å†™è¿™ä¸ªä¸œè¥¿å†™å¾—æ¯”è¾ƒå°‘ï¼Œä¹Ÿå°±åŠ å‡ ä¸ªé…ç½®æ–‡ä»¶ï¼Œ~~IDEA ç”Ÿæˆçš„è¶³å¤Ÿä½¿ç”¨äº†~~ã€‚

å‚è€ƒæ–‡ç« åŠæ–‡æ¡£ï¼š

[Recovering Deleted Files in GitHub - Rewind](https://rewind.com/blog/recovering-deleted-files-in-github/)

[Git - Book (git-scm.com)](https://git-scm.com/book/zh/v2)
[å¦‚ä½•é€‰æ‹©å¼€æºè®¸å¯è¯ï¼Ÿ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— (ruanyifeng.com)](https://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html)